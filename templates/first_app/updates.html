<!DOCTYPE html>
{% load staticfiles %}
<html>
	<head>
		<script src="{% static "js/jquery-3.2.1.min.js" %}"></script>
		<script>
		$(document).ready(function () {
    		$("#ckbCheckAll").click(function () {
       			$(".checkBoxClass").prop('checked', $(this).prop('checked'));
    		});
    
    		$(".checkBoxClass").change(function(){
        		if (!$(this).prop("checked")){
            		$("#ckbCheckAll").prop("checked",false);
       			}
    		});
		}); 
		</script>
		<script type="text/javascript">
                function ShowLoading(e) {
                var div = document.createElement('div');
                var img = document.createElement('img');
                img.src = '{% static "images/loading_bar.gif" %}';
                div.innerHTML = "Please Wait...<br />";
                div.style.cssText = 'position: fixed; top: 50%; left: 40%; z-index: 5000; width: 422px; text-align: center; background: #FFFFFF; border: 1px solid #000';
                div.appendChild(img);
                document.body.appendChild(div);
                return true;
                // These 2 lines cancel form submission, so only use if needed.
                //window.event.cancelBubble = true;
                //e.stopPropagation();
                }
                </script>

		<meta charset="utf-8">
		<title>{{ request.GET.hostname }}: Available Updates</title>
		<link rel="stylesheet" href="{% static "css/bootstrap.css" %}"/>
	</head>
	<body>
	{% include "first_app/navbar.html" %}
	<div class="jumbotron">
		<h1 class="text-center">System Updates</h1>
	</div>
		{% if availableupdates %}
		<h2 class="text-center">Here are the available updates on {{ request.GET.hostname }}:</h2>
		<p><p>

		<div class="container">
			
			<form method="POST" runat="server" onsubmit="ShowLoading()">

			<table class="table table-bordered" id="updatetable">
				<thead>
					<th>Package Name</th>
					<th>Current Version</th>
					<th>Available Update Version</th>
					<th>Update?</th>
				</thead>
				{% for package in availableupdates %}
				<tr>
					<td>{{ package.package }}</td>
					<td>{{ package.currentver }}</td>
					<td>{{ package.newver }}</td>
					<td><div class="material-switch pull-right"><input id="{{ package.package }}" type="checkbox" class="checkBoxClass" name="package" value="{{ package.package }}"><label for="{{ package.package }}" class="label-success"></label></div></td>
				</tr>	
				{% endfor %}
			
			</table>
			{% csrf_token %}
			
				<table class="table table-bordered text-center"><tr><td>
				<div class="material-switch2 pull-left"><input type="checkbox" id="ckbCheckAll"> Check All<label for="ckbCheckAll" class="label-success"></label></td><td> 
				<input type="submit" class="btn btn-primary" value="Update Selected"></div></td></tr>
				</table>
			</form>
			{% else %}
			<h2>No updates are currently available on {{ request.GET.hostname }}.</h2>
			{% endif %}

		</div>

	</body>
</html>
